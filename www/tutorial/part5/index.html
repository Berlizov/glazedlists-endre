<html>
<head><title>Glazed Lists Tutorial Part 5 - Custom Renderers</title>
</head>
<body>
<div class="app">


<h3>Glazed Lists Tutorial</h3>
<h1>Part 5 - Custom Renderers</h1>

The default cell renderer for JTables is quite plain. Glazed Lists comes with a
formatted renderer called <code>StyledDocumentRenderer</code>.

<h3>Using StyledDocumentRenderer</h3>
<p><code>StyledDocumentRenderer</code> is a wrapper for a <code>JTextPane</code>
as a <code>TableCellRenderer</code>. It provides a few default <code>Style</code>s
and some straightforward methods to create styled cells quickly and easily.
<p>To create a custom renderer, extend the <code>StyledDocumentRenderer</code> and
implement the <code>writeObject()</code> method. In this method you will receive
the object to render. The object parameter is actually the return value of your
<code>TableFormat</code>'s <code>getFieldValue()</code> method.
<p>The constructor of the custom renderer should call <code>super(true)</code> to
instantiate the <code>StyledDocumentRenderer</code>. A value of <code>false</code>
will prevent the renderer from modifying row heights.
<p>For our custom renderer, we're going to display the programming language name
and year in boldface text on the first line, with our description of the language
below. The table is going to have a single column, with all fields layed out within
that column.

<p><table cellpadding="5" cellspacing="0" width="100%" border="1" bgcolor="#EEEEEE"><tr><td><pre><code>import com.odellengineeringltd.glazedlists.jtable.*;
import javax.swing.*;

class ProgrammingLanguageRenderer <font color="#FF3333">extends StyledDocumentRenderer</font> {

    
    public ProgrammingLanguageRenderer() {
        <font color="#FF3333">super(true);</font>
    }

    <font color="#FF3333">public void writeObject(JTable table, Object value, 
        boolean isSelected, boolean hasFocus, int row, int column)</font> {
        
        ProgrammingLanguage language = (ProgrammingLanguage)value;
        
        <font color="#FF3333">append(</font>language.getName()<font color="#FF3333">, strong)</font>;
        <font color="#FF3333">append(</font>", "<font color="#FF3333">, strong)</font>;
        <font color="#FF3333">append(</font>language.getYear()<font color="#FF3333">, strong)</font>;
        <font color="#FF3333">append(</font>"\n"<font color="#FF3333">, plain)</font>;
        <font color="#FF3333">append(</font>language.getDescription()<font color="#FF3333">, plain)</font>;
        
    }
}</code></pre></td></tr></table>

<p>Note that the values of <code>strong</code> and <code>plain</code> are protected
<code>Style</code> variables in the <code>StyledDocumentRenderer</code> class. It
is straightforward to create custom styles if necessary. Put this code in the
constructor to create a new <code>Style</code> called "alert".

<p><table cellpadding="5" cellspacing="0" width="100%" border="1" bgcolor="#EEEEEE"><tr><td><pre><code>    Style alert = styledDocument.addStyle("alert", null);
    StyleConstants.setFontFamily(alert, "sansserif");
    StyleConstants.setFontSize(alert, 16);
    StyleConstants.setForeground(alert, new Color(255, 00, 00));
</code></pre></td></tr></table>

<h3>Fixing the TableFormat</h3>

<p>The <code>TableFormat</code> class works with our renderer to display the table
correctly. To change our renderer we must make adjustments to make in the
<code>TableFormat</code> as well.
<li>Currently, our renderer expects a <code>ProgrammingLanguage</code> as an argument. We need
to change our <code>TableFormat</code> so that it always returns a <code>ProgrammingLanguage</code>. 
<li>With our sophisticated renderer, we have added all of our values to a single cell.
We need to change our <code>TableFormat</code> to specify only one column. 
<li>Finally, we must configure our <code>TableFormat</code> to configure the table to use our renderer. 
We need to change the <code>configureTable()</code> method to have the table use our renderer.
The <code>configureTable()</code> method is called just after the table is constructed.

<p><table cellpadding="5" cellspacing="0" width="100%" border="1" bgcolor="#EEEEEE"><tr><td><pre><code>import com.odellengineeringltd.glazedlists.jtable.*;
import javax.swing.*;

public class ProgrammingLanguageTableCell implements TableFormat {

    public int getFieldCount() {
        <font color="#FF3333">return 1;</font>
    }

    public String getFieldName(int column) { 
        return "Programming Language";
    }
    
    public Object getFieldValue(Object baseObject, int column) {
        ProgrammingLanguage lang = (ProgrammingLanguage)baseObject;
        <font color="#FF3333">return lang;</font>
    }
    
    public void configureTable(JTable table) {
        <font color="#FF3333">table.getColumnModel().getColumn(0).setCellRenderer(new ProgrammingLanguageRenderer());</font>
    }

}</code></pre></td></tr></table>

<h3>Fixing the Sorter</h3>

<p>Originally we set our <code>TableComparatorChooser</code> so that clicking on the
name column sorted by name, and clicking on the year column sorted by year. As we
have collapsed all values into a single column, we need to update the
<code>TableComparatorChooser</code> to use just the single column.

<p><table cellpadding="5" cellspacing="0" width="100%" border="1" bgcolor="#EEEEEE"><tr><td><pre><code>    public void display() {
        ListTable listTable = new ListTable(customFilteredLanguages, new ProgrammingLanguageTableCell());
        
        <font color="#FF3333">TableComparatorChooser tableSorter = new TableComparatorChooser(listTable, sortedLanguages, false);</font>
        <font color="#FF3333">tableSorter.getComparatorsForColumn(0).clear();</font>
        <font color="#FF3333">tableSorter.getComparatorsForColumn(<font color="#FF3333">0</font>).add(<font color="#FF3333">new ProgrammingLanguageNameComparator()</font>);</font>
        <font color="#FF3333">tableSorter.getComparatorsForColumn(<font color="#FF3333">0</font>).add(<font color="#FF3333">new ProgrammingLanguageYearComparator()</font>);</font>
        
        JFrame frame = new JFrame("Programming Languages");
        frame.getContentPane().setLayout(new GridBagLayout());
        frame.getContentPane().add(new JLabel("Filter"), ...);
        frame.getContentPane().add(filteredLanguages.getFilterEdit(), ...);
        frame.getContentPane().add(customFilteredLanguages.getObjectOrientedCheckBox(), ...);
        frame.getContentPane().add(customFilteredLanguages.getVirtualMachineCheckBox(), ...);
        frame.getContentPane().add(listTable.getTableScrollPane(), ...);
        frame.setSize(640, 480);
        frame.show();
    }</code></pre></td></tr></table>

<p><img src="screenshot.gif" width="431" height="273" alt="Programming Languages Screen Shot">


<br><br><p><table cellpadding="0" cellspacing="0" width="100%" border="0"><tr>
<th align="left" width="30%"><a href="../part4/index.html">&lt;&lt; Part 4 - Sorting</a></th> 
<th align="center" width="40%"><a href="../index.html">Tutorial Home</a></th>
<th align="right" width="30%"><a href="../part6/index.html">Part 6 - Query Lists &gt;&gt;</a></th>
</tr></table><br><br><br>

</div>
</body>
</html>